<main class="assignments-container">
  
  <div class="header-box">
    <h2>{{ titre }}</h2>
    
    <div class="filters-container">
      <mat-form-field appearance="outline" class="search-field dense-field">
        <mat-label>Rechercher</mat-label>
        <input matInput [ngModel]="searchTerm" (keyup)="onSearchType($any($event.target).value)">
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>

      <mat-form-field appearance="outline" class="filter-field dense-field">
        <mat-select [(ngModel)]="filterRendu" (selectionChange)="onFilterChange()">
          <mat-option value="tous">Tous</mat-option>
          <mat-option value="rendu">Rendus</mat-option>
          <mat-option value="non-rendu">À faire</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </div>

  <div *ngIf="isLoading && assignments.length === 0" class="loading-container">
    <mat-spinner diameter="40"></mat-spinner>
    <p>Chargement des devoirs...</p>
  </div>

  <div *ngIf="!isLoading && totalDocs === 0" class="empty-state">
    <mat-icon class="empty-icon">assignment_late</mat-icon>
    <p>Aucun devoir trouvé.</p>
  </div>

  <div *ngIf="assignments.length > 0" [class.is-loading-data]="isLoading">
    <p class="total-count">Total : {{ totalDocs }} devoirs trouvés</p>

    <mat-list>
      <a mat-list-item
        *ngFor="let assignment of assignments"
        [routerLink]="['/assignment', assignment.id]"
        class="assignment-item">

        <h3 matListItemTitle [ngClass]="{'text-vert': assignment.rendu, 'text-rouge': !assignment.rendu}">
          {{ assignment.nom }}
        </h3>
        
        <p matListItemLine>Date : {{ assignment.dateDeRendu | date:'dd/MM/yyyy' }}</p>

        <div matListItemMeta>
          <span *ngIf="assignment.rendu" class="badge badge-vert">
            Rendu <mat-icon class="small-icon">check</mat-icon>
          </span>
          <span *ngIf="!assignment.rendu" class="badge badge-rouge">
            À rendre <mat-icon class="small-icon">close</mat-icon>
          </span>
        </div>

      </a>
    </mat-list>

    <div class="pagination">
      <button mat-icon-button (click)="premierePage()" [disabled]="page === 1"><mat-icon>first_page</mat-icon></button>
      <button mat-icon-button (click)="pagePrecedente()" [disabled]="!hasPrevPage"><mat-icon>chevron_left</mat-icon></button>
      <span class="page-info">{{ page }} / {{ totalPages }}</span>
      <button mat-icon-button (click)="pageSuivante()" [disabled]="!hasNextPage"><mat-icon>chevron_right</mat-icon></button>
      <button mat-icon-button (click)="dernierePage()" [disabled]="page === totalPages"><mat-icon>last_page</mat-icon></button>
    </div>
  </div>
</main>